import{bg as $,r as m,Y as L,j as e,cA as q,b4 as D,bS as t,I as d,B as O,aD as R,g as T,a as Y,b0 as u,b1 as h,a$ as B}from"./index-dd631538.js";import{P as x}from"./PasswordInput-af9069e7.js";import{A as z}from"./ActionLink-40d75935.js";import{u as V}from"./useTimeOutMessage-07ccc141.js";import{F as G,a as H,b as l}from"./formik.esm-56d92394.js";import{c as J,a as r,e as g}from"./index.esm-65d2e63a.js";const K=J().shape({name:r().required("Ingresar tu nombre"),email:r().email("Correo invalido").required("Ingresar tu correo"),email_confirm:r().oneOf([g("email")],"Tu correo no coincide"),password:r().required("Ingresa tu contraseña").min(6,"Minimo 6 caracteres"),confirmPassword:r().oneOf([g("password")],"Tu contraseña no coincide"),presenter_1:r().optional(),presenter_2:r().optional()}),Q=j=>{const{disableSubmit:b=!1,className:w,signInUrl:v="/sign-in"}=j,{uid:a,position:C}=$(),[P,_]=m.useState(null),[i,y]=m.useState(void 0),{signUp:I}=L(),[f,S]=V(),[F,E]=m.useState(!0),[M,X]=m.useState(!1),N=async(n,s)=>{if(a)try{const{name:o,password:U,email:k}=n;s(!0);const p=(await R(T(Y,"users/"+a))).data();if(!p)return;const A=p.left==C?"left":"right",c=await I({name:o,password:U,email:k,sponsor:p.name,sponsor_id:a,position:A,presenter1:"",presenter2:""});if((c==null?void 0:c.status)==="failed")switch(c.message.code){case"auth/email-already-in-use":{u.push(e.jsx(h,{title:"El correo electrónico proporcionado ya está registrado.",type:"warning"}),{placement:"top-center"});break}default:S(c.message)}s(!1)}catch(o){console.error(o),u.push(e.jsx(h,{title:o.toString(),type:"success"}),{placement:"top-center"})}};return m.useEffect(()=>{(async()=>{if(a&&a!==P)try{const s=await B(a);y(s),_(a),E(!1)}catch(s){console.log(s)}})()},[a]),e.jsx(e.Fragment,{children:F?e.jsx("span",{children:"Cargando..."}):e.jsx(e.Fragment,{children:a&&!M?e.jsxs("div",{className:w,children:[f&&e.jsx(q,{showIcon:!0,className:"mb-4",type:"danger",children:f}),e.jsx(G,{initialValues:{name:"",last_name:"",password:"",confirmPassword:"",email:"",email_confirm:"",sponsor:(i==null?void 0:i.name)||"",sponsor_id:a,presenter_1:"",presenter_2:""},validationSchema:K,onSubmit:(n,{setSubmitting:s})=>{b?s(!1):N(n,s)},children:({touched:n,errors:s,isSubmitting:o})=>e.jsx(H,{children:e.jsxs(D,{children:[e.jsx(t,{label:"Nombre",invalid:s.name&&n.name,errorMessage:s.name,children:e.jsx(l,{type:"text",autoComplete:"off",name:"name",placeholder:"Nombre",component:d})}),e.jsx(t,{label:"Email",invalid:s.email&&n.email,errorMessage:s.email,children:e.jsx(l,{type:"email",name:"email",placeholder:"Email",component:d})}),e.jsx(t,{label:"Confirmar Email",invalid:s.email_confirm&&n.email_confirm,errorMessage:s.email_confirm,children:e.jsx(l,{disablePaste:!0,type:"email",autoComplete:"off",name:"email_confirm",placeholder:"Confirmar Email",component:d})}),e.jsx(t,{label:"Contraseña",invalid:s.password&&n.password,errorMessage:s.password,children:e.jsx(l,{autoComplete:"off",name:"password",placeholder:"Password",component:x})}),e.jsx(t,{label:"Confirmar Contraseña",invalid:s.confirmPassword&&n.confirmPassword,errorMessage:s.confirmPassword,children:e.jsx(l,{autoComplete:"off",name:"confirmPassword",placeholder:"Confirm Password",component:x})}),e.jsx(t,{label:"Patrocinador",errorMessage:s.sponsor,children:e.jsx(l,{autoComplete:"off",name:"sponsor",placeholder:i==null?void 0:i.name,component:d,disabled:!0})}),e.jsx(O,{block:!0,loading:o,variant:"solid",type:"submit",children:o?"Creando cuenta...":"Registrarse"}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("span",{children:"¿Ya tienes una cuenta? "}),e.jsx(z,{to:v,children:"Inicia sesión"})]})]})})})]}):e.jsx("span",{className:"text-red-500",children:"Este enlace no es valido por el momento"})})})},W=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"mb-1",children:"Regístrate"}),e.jsx("p",{children:"Y empieza a aprender con nosotros"})]}),e.jsx(Q,{disableSubmit:!1})]}),ie=W;export{ie as default};
