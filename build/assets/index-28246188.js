import{r as _,u as b,j as a,B as F,d as N,o as O,c as Y,a as D,b as R,I as v,e as H,f as L,g as U,h as $,S as G}from"./index-dd631538.js";import{S as V}from"./index.esm-bb4ad11f.js";import{u as W,F as T,c as z,a as J,g as K,C as Z,f as aa}from"./ButtonSwapCurrency-1311b5dd.js";const B=["FA2000","FA5000","FA10000","FA20000"],A=({type:e,loading:l,createPaymentLink:o,options:h,founder:j})=>{const[d,n]=_.useState("monthly"),[s,u]=_.useState(!1),[x,c]=_.useState(!1),t=b(g=>g.auth.user),p=(g,i)=>{try{c(!0),o(e,g,d,i,t.email)}catch(y){console.error(y)}finally{}},m=()=>{u(!0)};return s?a.jsx("div",{className:"flex flex-col space-y-2",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4",children:[!B.includes(e)&&a.jsx(F,{className:"h-max",disabled:x,onClick:()=>p("MXN","Fiat"),children:a.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[a.jsx(V,{height:50,width:50,className:"h-[50px] w-[50px]"}),a.jsx("span",{children:"Fiat (MXN)"})]})}),!B.includes(e)&&a.jsx(F,{className:"h-max",disabled:x,onClick:()=>p("MXN","Coinpayments"),children:a.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[a.jsx("img",{src:"/img/insignias/USDT.svg",className:"w-[50px] h-[50px]"}),a.jsx("span",{children:"Tether (USDT)"})]})})]})}):a.jsx("div",{children:a.jsx(F,{loading:l,onClick:m,children:"Generar QR de Pago"})})},ea=({type:e,createPaymentLink:l,loading:o,period:h,buyer_email:j,founder:d,openModal:n})=>{var C,w,S,M;const s=b(f=>f.auth.user),{copy:u}=J(),[x,c]=_.useState(0),[t,p]=_.useState(!1),m=s.payment_link_automatic_franchises&&s.payment_link_automatic_franchises[e]&&((C=s.payment_link_automatic_franchises[e])==null?void 0:C.address),g=s.payment_link_automatic_franchises&&s.payment_link_automatic_franchises[e]&&((w=s.payment_link_automatic_franchises[e])==null?void 0:w.amount),i=s.payment_link_automatic_franchises&&s.payment_link_automatic_franchises[e]&&((S=s.payment_link_automatic_franchises[e])==null?void 0:S.expires_at),y=s.payment_link_automatic_franchises&&s.payment_link_automatic_franchises[e]&&((M=s.payment_link_automatic_franchises[e])==null?void 0:M.qrcode_url),r=N(i!=null&&i.seconds?(i==null?void 0:i.seconds)*1e3:null).isBefore(N()),E=async()=>{const f=Number(s.payment_link_automatic_franchises[e].amount);try{const k=await K(s.uid?s.uid:"",m||""),I=f-k,P=8,Q=Math.ceil(I*Math.pow(10,P))/Math.pow(10,P);k>0&&p(!0),c(Q)}catch(k){console.error("Error al calcular el monto pendiente: ",k),c(f)}};_.useEffect(()=>{if(s.uid){const f=O(Y(D,`users/${s.uid}/transactions`),()=>{E()});return()=>f()}},[s.uid]),_.useEffect(()=>{m&&s.payment_link_automatic_franchises&&s.payment_link_automatic_franchises[e]&&c(Number(s.payment_link_automatic_franchises[e].amount)||0)},[m,g]);const X=W(s.payment_link_automatic_franchises&&s.payment_link_automatic_franchises[e]&&s.payment_link_automatic_franchises[e].expires_at&&i&&!t?i.seconds*1e3:void 0),q=async()=>{const f=U(D,`users/${s.uid}`);await $(f,{payment_link_automatic_franchises:{}})};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-1 flex-col space-y-2 items-center",children:[a.jsx("span",{children:s.email}),r&&!t?null:a.jsx("div",{children:a.jsx("img",{src:y,className:R("h-[150px] w-[150px]",s.payment_link_automatic_franchises[e].currency=="MXN"&&"hidden")})}),a.jsx(v,{readOnly:!0,prefix:a.jsx(H,{}),value:r&&!t?"":m,className:R(s.payment_link_automatic_franchises[e].currency=="MXN"&&"hidden"),suffix:a.jsx("div",{className:"bg-gray-200 p-2 rounded-lg hover:cursor-pointer hover:bg-gray-300",onClick:()=>u(m),children:a.jsx(T,{})})}),a.jsxs("div",{className:r||t?"grid gap-x-4 w-full":"grid grid-cols-[30%_1fr] gap-x-4 w-full",children:[r||t?null:a.jsx(v,{readOnly:!0,prefix:a.jsx(L,{}),value:X}),a.jsx(v,{readOnly:!0,prefix:z[s.payment_link_automatic_franchises[e].currency||"BTC"],value:r&&!t?"":x.toFixed(8),suffix:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{children:s.payment_link_automatic_franchises[e].currency})," ",a.jsx("div",{className:"bg-gray-200 p-2 rounded-lg hover:cursor-pointer hover:bg-gray-300",onClick:()=>u(x.toFixed(8)||""),children:a.jsx(T,{})})]})})]}),!r&&s.payment_link_automatic_franchises[e].currency=="MXN"&&a.jsx(a.Fragment,{children:a.jsx("button",{className:"bg-green-600 rounded-md px-4 py-2 text-white text-xl hover:bg-green-800",onClick:()=>n(),children:"Pagar"})})]}),t?a.jsx("div",{children:a.jsxs("p",{className:"text-red-400 font-bold text-center",children:["Se detect칩 un pago",a.jsx("br",{}),"que no cubre la totalidad,",a.jsx("br",{}),"favor de pagar el resto."]})}):null,r&&!t?a.jsx("div",{children:a.jsx("p",{className:"text-red-400 font-bold text-center",children:"QR de pago caducado."})}):null,a.jsxs("div",{children:[a.jsxs("p",{className:"text-center",children:["La membresia se activar치 automaticamente",a.jsx("br",{}),"despues de confirmar el pago."]}),a.jsxs("button",{className:"rounded-md px-4 py-2 underline",onClick:()=>q(),children:["<-"," Cambiar metodo de pago"]})]}),r&&!t?a.jsx("div",{className:"flex justify-end space-x-1",children:a.jsx(F,{loading:o,disabled:!r,onClick:()=>l(e,s.payment_link_automatic_franchises[e].currency,h,"Coinpayments",j),children:"Calcular de nuevo"})}):null,s.payment_link_automatic_franchises[e]&&i&&a.jsxs("span",{className:"text-xs text-gray-300",children:["Tu membresia expir칩 el:"," ",N(i.seconds*1e3).format("YYYY-MM-DD HH:mm:ss")]})]})},sa=({type:e,loading:l,createPaymentLink:o,options:h,period:j,founder:d})=>{const n=b(c=>c.auth.user),s=n==null?void 0:n.membership_expires_at,u=s?N(s):null,x=N().add(1,"days");return s&&u&&u.isBefore(x.toDate())&&!n.payment_link_automatic_franchises||d&&!n.founder_pack&&!n.payment_link_automatic_franchises?a.jsx(a.Fragment,{children:a.jsx(A,{type:e,loading:l,createPaymentLink:o,options:h,founder:d})}):n.payment_link_automatic_franchises&&n.payment_link_automatic_franchises[e]&&n.payment_link_automatic_franchises[e].status=="pending"?a.jsx(a.Fragment,{children:a.jsx(ea,{type:e,loading:l,createPaymentLink:o,period:j,openModal:()=>{var c;window.open((c=n.payment_link_automatic_franchises)==null?void 0:c[e].redirect_url)},buyer_email:n.email})}):n.payment_link_automatic_franchises&&n.payment_link_automatic_franchises[e]&&n.payment_link_automatic_franchises[e].status=="confirming"?a.jsx(Z,{}):n.membership_status=="paid"?a.jsx(a.Fragment,{children:a.jsx(A,{type:e,loading:l,createPaymentLink:o,options:h,founder:d})}):!n.payment_link_automatic_franchises||!n.payment_link_automatic_franchises[e]?a.jsx(a.Fragment,{children:a.jsx(A,{type:e,loading:l,createPaymentLink:o,options:h,founder:d})}):a.jsx(G,{})},na=sa;function ia({name:e,binary_points:l,range_points:o,cap:h,image:j,days_label:d="Mensual"}){const[n,s]=_.useState(!1),u=b(p=>p.auth.user),[x,c]=_.useState("monthly"),t=async(p,m,g,i,y)=>{try{if(n)return;s(!0),c(g),await aa(u.uid,p,m,i,y)}catch(r){console.error(r)}finally{s(!1)}};return a.jsxs("div",{className:"flex flex-col rounded-md w-full p-4 space-y-4 transition-all duration-75 ring-gray-200 border",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("img",{src:j,alt:e,className:"max-h-[250px] max-w-[300px]"})}),a.jsxs("div",{className:"grid grid-cols-[min-content_1fr] w-max gap-x-4 ",children:[a.jsx("span",{className:"text-left",children:"Franquicia: "}),a.jsx("span",{className:"font-bold",children:e}),a.jsx("span",{className:"text-left truncate",children:"Puntos de Binario: "}),a.jsxs("span",{className:"font-bold",children:[l," puntos"]}),a.jsx("span",{className:"text-left truncate",children:"Puntos de Rango: "}),a.jsxs("span",{className:"font-bold",children:[o," puntos"]}),a.jsx("span",{className:"text-left",children:"CAP: "}),a.jsxs("span",{className:"font-bold",children:[h," dolares"]})]}),a.jsx(na,{type:e,loading:n,createPaymentLink:t,period:x,options:[{label:d,value:"monthly"}]})]})}const ta=[{name:"FA500",binary_points:50,range_points:100,cap:1e3,image:"/img/Franchises/FA500.png"},{name:"FA1000",binary_points:100,range_points:200,cap:2e3,image:"/img/Franchises/FA1000.png"},{name:"FA2000",binary_points:200,range_points:400,cap:4e3,image:"/img/Franchises/FA2000.png"},{name:"FA5000",binary_points:500,range_points:1e3,cap:1e4,image:"/img/Franchises/FA5000.png"},{name:"FA10000",binary_points:1e3,range_points:2e3,cap:2e4,image:"/img/Franchises/FA10000.png"},{name:"FA20000",binary_points:2e3,range_points:4e3,cap:4e4,image:"/img/Franchises/FA20000.png"}];function oa(){return a.jsx("div",{className:"flex flex-col h-full",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("div",{className:"flex items-center space-x-4",children:a.jsx("span",{className:"font-bold text-3xl",children:"Franquicias Autom치ticas"})}),a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 4xl:grid-cols-4 gap-y-2 gap-x-4",children:ta.map(e=>a.jsx(ia,{name:e.name,binary_points:e.binary_points,range_points:e.range_points,cap:e.cap,image:e.image},e.name))})]})})}export{oa as default};
