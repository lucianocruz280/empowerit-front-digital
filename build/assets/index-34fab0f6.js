import{u as y,r as d,j as e,D as w,B as v,bM as f,bN as _,bO as E,I as i,h as k,g as S,a as q,b0 as P,b1 as A}from"./index-dd631538.js";import{p as D}from"./products-96d808d1.js";import{f as N}from"./format-e6b86736.js";function M({onComplete:h}){const t=y(s=>s.auth.user),[c,r]=d.useState(D.filter(s=>s.distributor_usd_price!==void 0).map(s=>({id:s.id,product_galleries:[s.product_galleries[0]],name:s.name,sale_price:s.distributor_usd_price,price:s.sale_price,quantity:0}))),[p,u]=d.useState(!1);d.useState(!1);const[o,g]=d.useState(0),a=c.reduce((s,l)=>s+l.quantity,0),n=(s,l)=>{l<0||r(m=>{const j=[...m],x=j.findIndex(C=>C.id==s);return x>-1&&(s===9432090476817&&(l==4?l=0:l==1&&(l=5)),j[x].quantity=l),j})};d.useEffect(()=>{t&&t.credits_spent_this_month&&t.credits_spent_this_month>=100?u(!0):u(!1)},[t]),d.useEffect(()=>{t&&(()=>{let l=0;c.filter(x=>x.quantity).forEach(x=>{l+=x.sale_price*x.quantity});let m=0;a>=22?m=36:a>=10&&(m=18);const j=l+m;g(j)})()},[c]);const b=()=>{h()};return e.jsxs("div",{children:[e.jsxs(w,{isOpen:!p,onClose:()=>u(!0),children:[e.jsxs("div",{className:"space-y-1 flex flex-col",children:[e.jsx("p",{className:"font-bold text-xl",children:"Faltan requisitos"}),e.jsx("p",{className:"font-lg",children:"Para disfrutar de los beneficios de Marketplace Bono Distribuidor deberás de contar con un mínimo de 100 créditos utilizados en el mes."})]}),e.jsx("div",{className:"text-right mt-2",children:e.jsx(v,{onClick:()=>u(!0),children:"ACEPTAR"})})]}),e.jsx("img",{src:"/img/empoweritup.png",className:"w-[400px]"}),e.jsxs("p",{className:"flex font-bold text-lg mt-2",children:["Créditos utilizados en el mes:"," ",e.jsxs("span",{className:"ml-1 font-normal",children:[" ",t.credits_spent_this_month," créditos"]})]}),e.jsx("p",{className:"text-lg italic my-2",children:"Arma tu carrito y pagalo a precio preferencial"}),e.jsx("div",{className:"grid grid-cols-1  lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-x-4 gap-y-4",children:c.map(s=>e.jsxs("div",{className:"bg-gray-100 flex flex-col items-center rounded-lg px-4 pb-4",children:[e.jsx("img",{src:s.product_galleries[0].original_url,className:"w-[80%] flex-1 object-contain"}),e.jsx("div",{className:"flex justify-start w-full text-lg",children:e.jsx("span",{className:"font-bold",children:s.name})}),e.jsxs("div",{className:"flex justify-start w-full space-x-2",children:[e.jsxs("span",{className:"font-medium",children:["$ ",s.sale_price]}),e.jsxs("span",{className:"line-through text-gray-400",children:["$",Math.ceil(Number(s.price)/17)]})]}),s.id&&s.id==9432090476817&&e.jsx("div",{className:"flex justify-start w-full space-x-2",children:e.jsx("span",{children:"Minimo de compra: 5 unidades"})}),e.jsxs("div",{className:"flex justify-start items-center w-full pb-4 space-x-2",children:[e.jsxs("div",{className:"flex justify-start text-yellow-500 space-x-1",children:[e.jsx(f,{}),e.jsx(f,{}),e.jsx(f,{}),e.jsx(f,{}),e.jsx(f,{})]}),e.jsx("div",{children:e.jsx("span",{className:"font-medium",children:"En existencia"})})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{className:"rounded-full bg-black text-white p-2 text-lg hover:bg-slate-800 disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:!s.quantity,onClick:()=>n(s.id,s.quantity-1),children:e.jsx(_,{})}),e.jsx("input",{value:s.quantity,className:"flex-1 rounded-full text-black bg-gray-300 h-full text-center"}),e.jsx("button",{className:"rounded-full bg-black text-white p-2 text-lg hover:bg-slate-700",onClick:()=>n(s.id,s.quantity+1),children:e.jsx(E,{})})]})]},s.id.toString()))}),e.jsx("div",{className:"flex justify-end mt-8 w-full",children:e.jsxs("div",{className:"w-max text-lg px-4 border-t border-gray-400",children:[e.jsxs("div",{className:"w-full grid grid-cols-[max-content_1fr] gap-x-4 gap-y-2 pt-2",children:[e.jsx("div",{className:"font-bold text-right",children:"# Articulos"}),e.jsx("div",{children:a}),e.jsx("div",{className:"font-bold text-right",children:"Envio"}),e.jsxs("div",{children:["$"," ",N(a>=22?36:a>=10?18:12)," "]}),e.jsx("div",{className:"font-bold text-right",children:"Subtotal"}),e.jsxs("div",{children:["$"," ",N(c.reduce((s,l)=>s+l.sale_price*l.quantity,0),0,"-",!1)," "]}),e.jsx("div",{className:"font-bold text-right",children:"Total"}),e.jsxs("div",{children:["$ ",o]})]}),e.jsx("div",{className:"w-full mt-2",children:e.jsx("button",{className:"bg-black text-white rounded-full w-full p-2 disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:!(t.credits&&t.credits_spent_this_month&&t.credits_spent_this_month>=100&&o>0&&o<=t.credits),onClick:()=>b(),children:"Pagar"})})]})})]})}const T={country:"",state:"",city:"",cp:"",street:"",reference:"",num_ext:"",num_int:"",phone:"",colony:""};function R({onComplete:h,onBack:t}){const c=y(n=>n.auth.user),[r,p]=d.useState({address:T}),[u,o]=d.useState(!1),g=async()=>{try{if(!r.address.state)throw new Error("Estado es requerido");if(!r.address.city)throw new Error("Ciudad es requerido");if(!r.address.cp)throw new Error("CP es requerido");if(!r.address.street)throw new Error("Calle es requerido");if(!r.address.colony)throw new Error("Colonia es requerido");if(!r.address.phone)throw new Error("Telefono es requerido");if(!r.address.reference)throw new Error("Referencia es requerido");if(!r.address.num_ext)throw new Error("Número exterior es requerido");await k(S(q,`users/${c.uid}/cart/1`),{updated_at:new Date,address:r.address}),h()}catch(n){P.push(e.jsx(A,{title:n.toString(),type:"danger"}),{placement:"top-center"})}},a=n=>b=>{p({...r,address:{...r.address,[n]:b.target.value}})};return e.jsxs("div",{children:[e.jsxs(w,{isOpen:u,onClose:()=>o(!1),children:[e.jsx("p",{className:"text-center font-bold text-xl mb-2",children:"¿Tus datos son correctos?"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 justify-between p-4 rounded-lg",children:[e.jsxs("div",{className:"font-semibold",children:[e.jsx("p",{children:"Estado:"}),e.jsx("p",{children:"Ciudad:"}),e.jsx("p",{children:"Código Postal:"}),e.jsx("p",{children:"Colonia:"}),e.jsx("p",{children:"Calle:"}),e.jsx("p",{children:"Referencias:"}),e.jsx("p",{children:"Teléfono de contacto:"})]}),e.jsxs("div",{children:[e.jsx("p",{children:r.address.state}),e.jsx("p",{children:r.address.city}),e.jsx("p",{children:r.address.cp}),e.jsx("p",{children:r.address.colony}),e.jsx("p",{children:r.address.street}),e.jsx("p",{children:r.address.reference}),e.jsx("p",{children:r.address.phone})]})]}),e.jsxs("div",{className:"flex justify-between mx-4",children:[e.jsx(v,{onClick:()=>o(!1),children:"Regresar"}),e.jsx(v,{onClick:g,children:"Aceptar"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Páis"}),e.jsx(i,{value:"México",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Estado"}),e.jsx(i,{name:"state",value:r.address.state,onChange:a("state")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Ciudad"}),e.jsx(i,{name:"city",value:r.address.city,onChange:a("city")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Código Postal"}),e.jsx(i,{name:"cp",value:r.address.cp,onChange:a("cp")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Colonia"}),e.jsx(i,{name:"colony",value:r.address.colony,onChange:a("colony")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Calle"}),e.jsx(i,{name:"street",value:r.address.street,onChange:a("street")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Referencias"}),e.jsx(i,{name:"reference",value:r.address.reference,onChange:a("reference"),placeholder:"Entre calles"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Número Exterior"}),e.jsx(i,{name:"num_ext",value:r.address.num_ext,onChange:a("num_ext")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Número Interior (Opcional)"}),e.jsx(i,{name:"num_int",value:r.address.num_int,onChange:a("num_int")})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Télefono"}),e.jsx(i,{name:"phone",value:r.address.phone,onChange:a("phone")})]})]}),e.jsxs("div",{className:"flex justify-between mt-8",children:[e.jsxs("span",{className:"underline hover:cursor-pointer",onClick:t,children:["<"," Regresar al carrito"]}),e.jsx("button",{className:"bg-black text-white rounded-full px-6 py-2",onClick:()=>o(!0),children:"Pagar"})]})]})}function B(){const[h,t]=d.useState("cart");return h==="form"?e.jsx(R,{onComplete:()=>t("checkout"),onBack:()=>t("cart")}):e.jsx(M,{onComplete:()=>t("form")})}export{B as default};
