import{r as m,j as e,I as f,B as j,aT as y,aU as v,c as b,a as C,aX as E,b0 as n,b1 as c}from"./index-dd631538.js";function S(){const[p,d]=m.useState(!1),[a,u]=m.useState({email:"",credits:0}),[l,o]=m.useState({email:"",credits:""}),g=async r=>{d(!0),r.preventDefault();let t=!0;if(h(a.email)||(o(s=>({...s,email:"Correo electrónico no válido"})),t=!1),a.credits<=0&&(o(s=>({...s,credits:"Ingrese un numero valido"})),t=!1),t)try{const s=await y(v(b(C,"users"),E("email","==",a.email)));if(s.empty)n.push(e.jsx(c,{title:"Usuario no existe",type:"warning"}),{placement:"top-center"});else{const i=s.docs[0].id;await fetch(`https://empowerit-api.vercel.app/subscriptions/addCredits/${i}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credits:Number(a.credits)})}),n.push(e.jsx(c,{title:"Créditos agregados correctamente!!",type:"success"}),{placement:"top-center"})}}catch(s){console.error(s),d(!1),n.push(e.jsx(c,{title:"Ocurrio un error al agregar los creditos",type:"danger"}))}finally{d(!1),u({email:"",credits:0}),o({email:"",credits:""})}else n.push(e.jsx(c,{title:"Verifique los datos del formulario",type:"danger"}))},x=r=>{const{value:t,name:s}=r.target;u(i=>({...i,[s]:t})),s==="email"&&o(i=>({...i,email:h(t)?"":"Correo electrónico no válido"}))},h=r=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r);return e.jsx("div",{children:e.jsx("form",{className:"flex flex-col space-y-3",onSubmit:g,children:e.jsxs("div",{className:"md:w-1/2 space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Correo Electrónico: "}),e.jsx(f,{placeholder:"Email",name:"email",value:a.email,onChange:x}),l.email&&e.jsx("span",{className:"text-red-500",children:l.email})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Créditos a Agregar: "}),e.jsx(f,{type:"number",placeholder:"0",name:"credits",value:a.credits,onChange:x}),l.credits&&e.jsx("span",{className:"text-red-500",children:l.credits})]}),e.jsx(j,{loading:p,disabled:p,children:"Agregar"})]})})})}export{S as default};
