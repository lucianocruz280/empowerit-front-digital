import{u as k,j as s,bw as V,b as E,bx as p,aU as Z,c as ee,a as A,aX as te,aW as re,by as se,aT as ae,d as I,r as x,bq as ne,br as de,bs as L,bt as g,bu as oe,bv as y,bm as H,bn as B,bz as R,bo as ie,W as ce,bA as le,bB as W,bC as ue,aK as me,bD as be,aD as fe,g as pe,I as xe,bE as he}from"./index-dd631538.js";const ge=t=>{const{className:e,children:r,bodyClass:a,leftSideBorder:o,rightSideBorder:c,divider:u,shadow:i,isLastChild:d,...m}=t,l=k(b=>b.theme.layout.type);return s.jsx(V,{className:E(e,l===p&&"border-0",l===p&&c&&"ltr:border-r-0 rtl:border-l-0 ltr:md:border-r rtl:md:border-l md:border-gray-200 md:dark:border-gray-600 rounded-tr-none rounded-br-none rtl:rounded-tr-none rtl:rounded-br-none",l===p&&o&&"ltr:border-l-0 rtl:border-r-0 ltr:md:border-l rtl:md:border-r md:border-gray-200 md:dark:border-gray-600 rounded-tl-none rounded-bl-none rtl:rounded-tl-none rtl:rounded-bl-none",l===p&&u&&`${d?"":"border-b pb-6"} py-4 md:border-gray-200 md:dark:border-gray-600 rounded-br-none rounded-bl-none`,l!==p&&i&&"rounded-none shadow-none border-0"),...m,bodyClass:E(l===p?"card-gutterless":"",a),children:r})};async function F(t){try{const e=Z(ee(A,"users"),te("sponsor_id","==",t),re("created_at","desc")),r=await se(e);return{status:"success",data:{data:(await ae(e)).docs.map(q),total:Number(r.data().count)}}}catch(e){return console.error(e),{status:"failed",e}}}const q=t=>{const e=t.data();return{id:t.id,...e,subscription_expires_at:e.subscription_expires_at?I(e.subscription_expires_at.seconds*1e3).format("YYYY-MM-DD HH:mm:ss"):null,created_at:e.created_at?I(e.created_at.seconds*1e3).format("YYYY-MM-DD HH:mm:ss"):null,updated_at:e.updated_at?I(e.updated_at.seconds*1e3).format("YYYY-MM-DD HH:mm:ss"):null}},P=x.createContext({datatable:[],setDatatable:()=>{},fetchData:()=>Promise.resolve()}),ye=t=>{const[e,r]=x.useState([]),a=k(c=>c.auth.user),o=x.useCallback(async()=>{const c=await F(a.uid);c.data&&r(c.data.data)},[a.uid]);return x.useEffect(()=>{o()},[]),s.jsx(P.Provider,{value:{datatable:e,setDatatable:r,fetchData:o},children:t.children})},z=()=>x.useContext(P),je=()=>{const{datatable:t}=z();return s.jsxs(ne,{children:[s.jsx(de,{children:s.jsxs(L,{children:[s.jsx(g,{children:"Nombre"}),s.jsx(g,{children:"Email"}),s.jsx(g,{children:"Membresia"}),s.jsx(g,{children:"Lado"}),s.jsx(g,{children:"Fecha de inicio"})]})}),s.jsx(oe,{children:t.map(e=>s.jsxs(L,{children:[s.jsx(y,{children:e.name}),s.jsx(y,{children:e.email}),s.jsx(y,{children:s.jsx("span",{children:e.membership&&e.membership_status=="paid"?s.jsx("span",{children:e.membership}):s.jsx("span",{className:"text-red-500",children:"Expirado"})})}),s.jsx(y,{children:s.jsx("span",{children:e.position=="left"?"Izquierda":"Derecha"})}),s.jsx(y,{children:s.jsx("span",{children:e.created_at})})]},e.id))})]})},U="salesOrderList",O=H(U+"/getOrders",async t=>({total:0,data:[]})),Re={loading:!1,orderList:[],tableData:{total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},selectedRows:[],selectedRow:"",deleteMode:""},Se=B({name:`${U}/state`,initialState:Re,reducers:{setOrderList:(t,e)=>{t.orderList=e.payload},setTableData:(t,e)=>{t.tableData=e.payload},setSelectedRows:(t,e)=>{t.selectedRows=e.payload},setSelectedRow:(t,e)=>{t.selectedRow=e.payload},addRowItem:(t,{payload:e})=>{const r=R(t);r.selectedRows.includes(e)||(t.selectedRows=[...r.selectedRows,...e])},removeRowItem:(t,{payload:e})=>{const r=R(t);r.selectedRows.includes(e)&&(t.selectedRows=r.selectedRows.filter(a=>a!==e))},setDeleteMode:(t,e)=>{t.deleteMode=e.payload}},extraReducers:t=>{t.addCase(O.fulfilled,(e,r)=>{e.orderList=r.payload.data,e.tableData.total=r.payload.total,e.loading=!1}).addCase(O.pending,e=>{e.loading=!0})}}),we=Se.reducer,X="inscriptionsSlice",N=H(X+"/getInscriptions",async({tableQuery:t,userId:e})=>{var a,o;const r=await F(e);return{data:(a=r.data)==null?void 0:a.data,total:(o=r.data)==null?void 0:o.total}}),De={loading:!1,inscriptionList:[],tableData:{total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},selectedRows:[],selectedRow:"",deleteMode:""},Ie=B({name:`${X}/state`,initialState:De,reducers:{setInscriptionList:(t,e)=>{t.inscriptionList=e.payload},setTableData:(t,e)=>{t.tableData=e.payload},setSelectedRows:(t,e)=>{t.selectedRows=e.payload},setSelectedRow:(t,e)=>{t.selectedRow=e.payload},addRowItem:(t,{payload:e})=>{const r=R(t);r.selectedRows.includes(e)||(t.selectedRows=[...r.selectedRows,...e])},removeRowItem:(t,{payload:e})=>{const r=R(t);r.selectedRows.includes(e)&&(t.selectedRows=r.selectedRows.filter(a=>a!==e))},setDeleteMode:(t,e)=>{t.deleteMode=e.payload}},extraReducers:t=>{t.addCase(N.fulfilled,(e,r)=>{e.inscriptionList=r.payload.data||[],e.tableData.total=r.payload.total||0,e.loading=!1}).addCase(N.pending,e=>{e.loading=!0})}}),ve=Ie.reducer;ie({data:we,inscriptions:ve});const Te=ce;var _e=le,Ce=function(){return _e.Date.now()},Ee=Ce,Le=/\s/;function Oe(t){for(var e=t.length;e--&&Le.test(t.charAt(e)););return e}var Ne=Oe,Me=Ne,$e=/^\s+/;function Ye(t){return t&&t.slice(0,Me(t)+1).replace($e,"")}var ke=Ye,Ae=ke,M=W,He=ue,$=0/0,Be=/^[-+]0x[0-9a-f]+$/i,We=/^0b[01]+$/i,Fe=/^0o[0-7]+$/i,qe=parseInt;function Pe(t){if(typeof t=="number")return t;if(He(t))return $;if(M(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=M(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Ae(t);var r=We.test(t);return r||Fe.test(t)?qe(t.slice(2),r?2:8):Be.test(t)?$:+t}var ze=Pe,Ue=W,v=Ee,Y=ze,Xe="Expected a function",Ke=Math.max,Qe=Math.min;function Ge(t,e,r){var a,o,c,u,i,d,m=0,l=!1,b=!1,S=!0;if(typeof t!="function")throw new TypeError(Xe);e=Y(e)||0,Ue(r)&&(l=!!r.leading,b="maxWait"in r,c=b?Ke(Y(r.maxWait)||0,e):c,S="trailing"in r?!!r.trailing:S);function w(n){var f=a,h=o;return a=o=void 0,m=n,u=t.apply(h,f),u}function K(n){return m=n,i=setTimeout(j,e),l?w(n):u}function Q(n){var f=n-d,h=n-m,C=e-f;return b?Qe(C,c-h):C}function T(n){var f=n-d,h=n-m;return d===void 0||f>=e||f<0||b&&h>=c}function j(){var n=v();if(T(n))return _(n);i=setTimeout(j,Q(n))}function _(n){return i=void 0,S&&a?w(n):(a=o=void 0,u)}function G(){i!==void 0&&clearTimeout(i),m=0,a=d=o=i=void 0}function J(){return i===void 0?u:_(v())}function D(){var n=v(),f=T(n);if(a=arguments,o=this,d=n,f){if(i===void 0)return K(d);if(b)return clearTimeout(i),i=setTimeout(j,e),w(d)}return i===void 0&&(i=setTimeout(j,e)),u}return D.cancel=G,D.flush=J,D}var Je=Ge;const Ve=me(Je),Ze=()=>{const{setDatatable:t,fetchData:e}=z(),r=Te(d=>d.auth.user),a=x.useRef(null),o=Ve(c,500);function c(d){u(d)}const u=async d=>{if(d){const m=await be.search(d,{filters:`sponsor_id:${r.uid}`}),l=await Promise.all(m.hits.map(async b=>fe(pe(A,`users/${b.objectID}`)).then(q)));t(l)}else e()},i=d=>{o(d.target.value)};return s.jsx(xe,{ref:a,className:"lg:w-52",size:"sm",placeholder:"Search",prefix:s.jsx(he,{className:"text-lg"}),onChange:i})},et=()=>s.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4",children:s.jsx(Ze,{})}),tt=()=>s.jsx(ye,{children:s.jsxs(ge,{className:"h-full",bodyClass:"h-full",children:[s.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"mb-4 lg:mb-0",children:"Inscripciones"}),s.jsx(et,{})]}),s.jsx(je,{})]})}),st=tt;export{st as default};
