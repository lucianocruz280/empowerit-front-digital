import{aM as Se,r as s,K as d,cw as ge,cx as E,O as Oe,cy as xe,cz as je,bF as be,j as e,cA as we,b4 as ye,bS as m,I as Q,b8 as Ce,co as U,B as Pe,b0 as X,b1 as Y,aT as _e,c as Ie,a as Le}from"./index-dd631538.js";import{P as Z}from"./PasswordInput-af9069e7.js";import{u as Me}from"./useTimeOutMessage-07ccc141.js";import{F as Ae,a as Ee,b as $}from"./formik.esm-56d92394.js";import{c as $e,a as P,e as Fe}from"./index.esm-65d2e63a.js";import{b as Re}from"./packs-85a17dc4.js";var Ne=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];function Ve(r){var f=r.defaultOptions,i=f===void 0?!1:f,p=r.cacheOptions,h=p===void 0?!1:p,v=r.loadOptions;r.options;var b=r.isLoading,_=b===void 0?!1:b,I=r.onInputChange,S=r.filterOption,F=S===void 0?null:S,g=Se(r,Ne),L=g.inputValue,c=s.useRef(void 0),O=s.useRef(!1),n=s.useState(Array.isArray(i)?i:void 0),a=d(n,2),l=a[0],t=a[1],u=s.useState(typeof L<"u"?L:""),x=d(u,2),M=x[0],R=x[1],ee=s.useState(i===!0),k=d(ee,2),ae=k[0],w=k[1],se=s.useState(void 0),z=d(se,2),N=z[0],V=z[1],te=s.useState([]),B=d(te,2),ne=B[0],q=B[1],oe=s.useState(!1),W=d(oe,2),re=W[0],A=W[1],ie=s.useState({}),G=d(ie,2),y=G[0],J=G[1],le=s.useState(void 0),K=d(le,2),ue=K[0],de=K[1],pe=s.useState(void 0),H=d(pe,2),ce=H[0],me=H[1];h!==ce&&(J({}),me(h)),i!==ue&&(t(Array.isArray(i)?i:void 0),de(i)),s.useEffect(function(){return O.current=!0,function(){O.current=!1}},[]);var T=s.useCallback(function(C,j){if(!v)return j();var o=v(C,j);o&&typeof o.then=="function"&&o.then(j,function(){return j()})},[v]);s.useEffect(function(){i===!0&&T(M,function(C){O.current&&(t(C||[]),w(!!c.current))})},[]);var fe=s.useCallback(function(C,j){var o=ge(C,j,I);if(!o){c.current=void 0,R(""),V(""),q([]),w(!1),A(!1);return}if(h&&y[o])R(o),V(o),q(y[o]),w(!1),A(!1);else{var ve=c.current={};R(o),w(!0),A(!N),T(o,function(D){O&&ve===c.current&&(c.current=void 0,w(!1),V(o),q(D||[]),A(!1),J(D?E(E({},y),{},Oe({},o,D)):y))})}},[h,T,N,y,I]),he=re?[]:M&&N?ne:l||[];return E(E({},g),{},{options:he,isLoading:ae||_,onInputChange:fe,filterOption:F})}var qe=s.forwardRef(function(r,f){var i=Ve(r),p=xe(i);return s.createElement(je,be({ref:f},p))}),Te=qe;const De=$e().shape({name:P().required("Por favor ingrese su nombre"),email:P().trim().email("Email invalido").required("Por favor ingrese su email"),password:P().required("Por favor ingrese su contraseña"),confirmPassword:P().oneOf([Fe("password")],"Las contraseñas no coinciden"),membership:P().required("Membresia requerida")}),Ue=r=>{const{disableSubmit:f=!1,className:i}=r,[p,h]=s.useState("right"),[v,b]=Me(),[_,I]=s.useState([]),[S,F]=s.useState(null),[g,L]=s.useState(null),c=async(n,a)=>{if(!S){b("Seleccionar sponsor");return}try{const{name:l,password:t,email:u}=n;a(!0);const x=await fetch("https://empowerit-api.vercel.app/subscriptions/activeWithoutVolumen",{headers:{"Content-Type":"application/json"},body:JSON.stringify({name:l,password:t,email:u.trim(),sponsor:S.name,sponsor_id:S.value,side:p,days:30,membership:g==null?void 0:g.value}),method:"POST"}).then(M=>M.json());(x==null?void 0:x.statusCode)===500?X.push(e.jsx(Y,{title:"Algo salio mal",type:"danger"}),{placement:"top-center"}):(X.push(e.jsx(Y,{title:"Registrado correctamente",type:"success"}),{placement:"top-center"}),setTimeout(()=>{window.location.reload()},200)),a(!1)}catch(l){b(l.toString()),a(!1)}},O=(n,a)=>{_e(Ie(Le,"users")).then(l=>{let t=[];_.length==0?(l.docs.forEach(u=>{t.push({value:u.id,label:u.data().name+" - ("+u.data().email+")",name:u.data().name})}),I(t)):t=_,a(t.filter(({label:u})=>n?u.toLowerCase().includes(n.toLocaleLowerCase()):!0))})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:i,children:[v&&e.jsx(we,{showIcon:!0,className:"mb-4",type:"danger",children:v}),e.jsx(Ae,{initialValues:{name:"",last_name:"",password:"",confirmPassword:"",email:"",sponsor:"",sponsor_id:"",membership:"100-pack",position:"right"},validationSchema:De,onSubmit:(n,{setSubmitting:a})=>{f?a(!1):c(n,a)},children:({touched:n,errors:a,isSubmitting:l})=>e.jsx(Ee,{children:e.jsxs(ye,{children:[e.jsx(m,{label:"Nombre",invalid:a.name&&n.name,errorMessage:a.name,children:e.jsx($,{type:"text",autoComplete:"off",name:"name",placeholder:"Nombre",component:Q})}),e.jsx(m,{label:"Email",invalid:a.email&&n.email,errorMessage:a.email,children:e.jsx($,{type:"email",autoComplete:"off",name:"email",placeholder:"Email",component:Q})}),e.jsx(m,{label:"Password",invalid:a.password&&n.password,errorMessage:a.password,children:e.jsx($,{autoComplete:"off",name:"password",placeholder:"Password",component:Z})}),e.jsx(m,{label:"Confirm Password",invalid:a.confirmPassword&&n.confirmPassword,errorMessage:a.confirmPassword,children:e.jsx($,{autoComplete:"off",name:"confirmPassword",placeholder:"Confirm Password",component:Z})}),e.jsx(m,{label:"Patrocinador",errorMessage:a.sponsor,children:e.jsx(Te,{cacheOptions:!0,loadOptions:O,onChange:t=>F(t),defaultOptions:!0,name:"sponsor_id"})}),e.jsx(m,{label:"Membresia",errorMessage:a.sponsor,children:e.jsx(Ce,{name:"membership",options:Re,onChange:t=>L(t)})}),e.jsx(m,{label:"Lado",errorMessage:a.sponsor,children:e.jsxs(U.Group,{value:p,onChange:t=>h(t),children:[e.jsx(U,{value:"left",children:"Izquierda"},"left"),e.jsx(U,{value:"right",children:"Derecha"},"right")]})}),e.jsx(Pe,{block:!0,loading:l,variant:"solid",type:"submit",children:l?"Creando cuenta...":"Registrar"})]})})})]})})},ke=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"mb-1",children:"Registrar usuario"}),e.jsx("p",{children:"Registrar y activar academia inmediatamente"})]}),e.jsx(Ue,{disableSubmit:!1})]}),He=ke;export{He as default};
