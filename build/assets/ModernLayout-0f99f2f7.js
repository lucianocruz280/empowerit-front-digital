import{r as o,u as f,j as e,B as _,d as k,o as H,c as X,a as F,b as M,I as b,e as I,f as L,g as Q,h as U,S as Y,D as q}from"./index-dd631538.js";import{H as $,M as G,U as V}from"./navigation-icon.config-c391939d.js";import{S as K,a as W}from"./SideNav-3f6eb0b2.js";import{V as z}from"./Views-34b2bc56.js";import{O as D}from"./packs-85a17dc4.js";import{u as J,F as P,c as Z,a as ee,g as se,C as re,b as ae}from"./ButtonSwapCurrency-1311b5dd.js";import{S as ne}from"./index.esm-bb4ad11f.js";import"./withHeaderItem-97bb3b7f.js";import"./index.esm-380fcd9f.js";import"./index.esm-0de0d3b4.js";import"./VerticalMenuContent-dcc1c884.js";import"./ConditionalWrapper-9fa2e41e.js";const A=({type:s,loading:c,createPaymentLink:l,founder:a})=>{o.useState("monthly");const[r,m]=o.useState(!1),[t,p]=o.useState(!1),n=f(j=>j.auth.user),h=(j,i)=>{try{p(!0),l(s,j,i,n.email)}catch(y){console.error(y)}finally{}},d=()=>{m(!0)};return r?e.jsx("div",{className:"flex flex-col space-y-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4",children:[e.jsx(_,{className:"h-max",disabled:t,onClick:()=>h("MXN","Fiat"),children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx(ne,{height:50,width:50,className:"h-[50px] w-[50px]"}),e.jsx("span",{children:"Fiat (MXN)"})]})}),e.jsx(_,{className:"h-max",disabled:t,onClick:()=>h("MXN","Coinpayments"),children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("img",{src:"/img/insignias/USDT.svg",className:"w-[50px] h-[50px]"}),e.jsx("span",{children:"Tether (USDT)"})]})})]})}):e.jsx("div",{children:e.jsx(_,{loading:c,onClick:d,children:"Generar QR de Pago"})})},ie=({type:s,createPaymentLink:c,loading:l,openModal:a})=>{var N,v,C,w;const r=f(x=>x.auth.user),{copy:m}=ee(),[t,p]=o.useState(0),[n,h]=o.useState(!1),d=r.payment_link_credits&&r.payment_link_credits[s]&&((N=r.payment_link_credits[s])==null?void 0:N.address),j=r.payment_link_credits&&r.payment_link_credits[s]&&((v=r.payment_link_credits[s])==null?void 0:v.amount),i=r.payment_link_credits&&r.payment_link_credits[s]&&((C=r.payment_link_credits[s])==null?void 0:C.expires_at),y=r.payment_link_credits&&r.payment_link_credits[s]&&((w=r.payment_link_credits[s])==null?void 0:w.qrcode_url),u=k(i!=null&&i.seconds?(i==null?void 0:i.seconds)*1e3:null).isBefore(k()),E=async()=>{const x=Number(r.payment_link_credits[s].amount);try{const g=await se(r.uid?r.uid:"",d||""),O=x-g,S=8,B=Math.ceil(O*Math.pow(10,S))/Math.pow(10,S);g>0&&h(!0),p(B)}catch(g){console.error("Error al calcular el monto pendiente: ",g),p(x)}};o.useEffect(()=>{if(r.uid){const x=H(X(F,`users/${r.uid}/transactions`),()=>{E()});return()=>x()}},[r.uid]),o.useEffect(()=>{d&&r.payment_link_credits&&r.payment_link_credits[s]&&p(Number(r.payment_link_credits[s].amount)||0)},[d,j]);const R=J(r.payment_link_credits&&r.payment_link_credits[s]&&r.payment_link_credits[s].expires_at&&i&&!n?i.seconds*1e3:void 0),T=async()=>{const x=Q(F,`users/${r.uid}`);await U(x,{payment_link_credits:{}})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-1 flex-col space-y-2 items-center",children:[e.jsx("span",{children:r.email}),u&&!n?null:e.jsx("div",{children:e.jsx("img",{src:y,className:M("h-[150px] w-[150px]",r.payment_link_credits[s].currency=="MXN"&&"hidden")})}),e.jsx(b,{readOnly:!0,prefix:e.jsx(I,{}),value:u&&!n?"":d,className:M(r.payment_link_credits[s].currency=="MXN"&&"hidden"),suffix:e.jsx("div",{className:"bg-gray-200 p-2 rounded-lg hover:cursor-pointer hover:bg-gray-300",onClick:()=>m(d),children:e.jsx(P,{})})}),e.jsxs("div",{className:u||n?"grid gap-x-4 w-full":"grid grid-cols-[30%_1fr] gap-x-4 w-full",children:[u||n?null:e.jsx(b,{readOnly:!0,prefix:e.jsx(L,{}),value:R}),e.jsx(b,{readOnly:!0,prefix:Z[r.payment_link_credits[s].currency||"BTC"],value:u&&!n?"":t.toFixed(8),suffix:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:r.payment_link_credits[s].currency})," ",e.jsx("div",{className:"bg-gray-200 p-2 rounded-lg hover:cursor-pointer hover:bg-gray-300",onClick:()=>m(t.toFixed(8)||""),children:e.jsx(P,{})})]})})]}),!u&&r.payment_link_credits[s].currency=="MXN"&&e.jsx("div",{className:"flex justify-between space-x-2 w-full py4",children:e.jsx("button",{className:"bg-green-600 rounded-md px-4 py-2 text-white text-xl hover:bg-green-800",onClick:()=>a(),children:"Pagar"})})]}),n?e.jsx("div",{children:e.jsxs("p",{className:"text-red-400 font-bold text-center",children:["Se detectó un pago",e.jsx("br",{}),"que no cubre la totalidad,",e.jsx("br",{}),"favor de pagar el resto."]})}):null,u&&!n?e.jsx("div",{children:e.jsx("p",{className:"text-red-400 font-bold text-center",children:"QR de pago caducado."})}):null,e.jsx("div",{children:e.jsxs("p",{className:"text-center",children:["Los créditos se te añadiran",e.jsx("br",{}),"despues de confirmar el pago."]})}),e.jsx("div",{children:e.jsxs("button",{className:"rounded-md px-4 py-2 underline",onClick:()=>T(),children:["<-"," Cambiar metodo de pago"]})}),u&&!n?e.jsx("div",{className:"flex justify-end space-x-1",children:e.jsx(_,{loading:l,disabled:!u,onClick:()=>c(s,r.payment_link_credits[s].currency),children:"Calcular de nuevo"})}):null,r.payment_link_credits[s]&&i&&e.jsxs("span",{className:"text-xs text-gray-300",children:["Tu membresia expiró el:"," ",k(i.seconds*1e3).format("YYYY-MM-DD HH:mm:ss")]})]})},te=({type:s,loading:c,createPaymentLink:l})=>{const a=f(r=>r.auth.user);return a.payment_link_credits&&a.payment_link_credits[s]&&a.payment_link_credits[s].status=="pending"?e.jsx(e.Fragment,{children:e.jsx(ie,{type:s,loading:c,createPaymentLink:l,openModal:()=>{window.open(a.payment_link_credits[s].redirect_url)}})}):a.payment_link_credits&&a.payment_link_credits[s]&&a.payment_link_credits[s].status=="confirming"?e.jsx(re,{}):a.membership_status=="paid"?e.jsx(e.Fragment,{children:e.jsx(A,{type:s,loading:c,createPaymentLink:l})}):!a.payment_link_credits||!a.payment_link_credits[s]?e.jsx(e.Fragment,{children:e.jsx(A,{type:s,loading:c,createPaymentLink:l})}):e.jsx(Y,{})};function ce(){const[s,c]=o.useState(!1),l=f(n=>n.auth.user),[a,r]=o.useState("100-credits"),m=async(n,h,d,j)=>{try{if(s)return;c(!0),await ae(l.uid,n,h,d,l.email)}catch(i){console.error(i)}finally{c(!1)}},t={"30-credits":15,"50-credits":25,"100-credits":50,"500-credits":250,"1000-credits":500},p=n=>{r(n.target.value)};return e.jsxs("div",{className:"flex flex-col max-w-28 rounded-md w-full ring-1 ring-gray-200 p-4 justify-center mt-2 space-y-1",children:[e.jsx("img",{src:"/img/credits.jpeg",className:"mx-auto h-[300px] w-[300px] rounded-lg mb-3"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("span",{className:"max-w-xs truncate",children:"Puntos de Binario:  "}),e.jsxs("span",{className:"font-bold",children:[t[a]," puntos"]})]}),e.jsxs("select",{className:"p-1 w-full rounded-lg border",value:a,onChange:p,children:[e.jsx("option",{value:"30-credits",children:"30 créditos"}),e.jsx("option",{value:"50-credits",children:"50 créditos"}),e.jsx("option",{value:"100-credits",children:"100 créditos"}),e.jsx("option",{value:"500-credits",children:"500 créditos"}),e.jsx("option",{value:"1000-credits",children:"1000 créditos"})]}),e.jsx(te,{type:a,loading:s,createPaymentLink:m})]})}const le=()=>e.jsxs(e.Fragment,{children:[e.jsx(G,{}),e.jsx(W,{})]}),de=()=>{var r,m;const s=f(t=>t.auth.user),[c,l]=o.useState(!1),a=["49-pack","100-pack","300-pack","500-pack","1000-pack","2000-pack","3000-pack","FD200","FD300","FD500","FP200","FP300","FP500"].includes(s.membership??"");return e.jsxs(e.Fragment,{children:[(s==null?void 0:s.membership)&&e.jsxs("div",{className:"flex items-center",children:[a?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:`/img/Franchises/${s.membership}.png`,className:"h-[50px] w-auto",width:80,height:80}),e.jsx("span",{children:s.membership})]}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:(r=D.find(t=>t.value==s.membership))==null?void 0:r.image,className:"h-[50px] w-auto",width:80,height:80}),e.jsx("span",{children:(m=D.find(t=>t.value==s.membership))==null?void 0:m.label})]}),e.jsxs(q,{isOpen:c,onClose:()=>l(!1),children:[e.jsx("h3",{children:"Recarga créditos"}),e.jsx(ce,{})]})]}),e.jsx(V,{hoverable:!1})]})},be=()=>e.jsx("div",{className:"app-layout-modern flex flex-auto flex-col",children:e.jsxs("div",{className:"flex flex-auto min-w-0",children:[e.jsx(K,{}),e.jsxs("div",{className:"flex flex-col flex-auto min-h-screen min-w-0 relative w-full bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700",children:[e.jsx($,{className:"border-b border-gray-200 dark:border-gray-700",headerEnd:e.jsx(de,{}),headerStart:e.jsx(le,{})}),e.jsx(z,{})]})]})});export{be as default};
