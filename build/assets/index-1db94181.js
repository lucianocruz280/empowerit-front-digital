import{a2 as xe,r,u as M,aS as pe,o as te,g as ce,a as D,aT as R,c as F,aU as H,aV as he,aW as U,aX as ae,j as e,S as ue,af as fe,aY as le,D as V,d as de,aZ as K,a_ as X,a$ as je,b as Z,b0 as Y,b1 as G,i as be,b2 as ge,b3 as Ne,aH as ye,b4 as ve,I as h,b5 as ee,b6 as Ce,b7 as _e,b8 as re,b9 as we,ba as Se,bb as ke,bc as ie,bd as ne,B as De,aF as Fe,be as Be}from"./index-dd631538.js";import{r as Ee}from"./index-e93e3954.js";import{a as qe}from"./Views-34b2bc56.js";import{b as Pe,F as Re,c as Me,d as Le}from"./index.esm-380fcd9f.js";import{f as Ae}from"./format-e6b86736.js";import{F as ze,a as O}from"./FormRow-59e55473.js";import{F as $e,a as Te,b as x}from"./formik.esm-56d92394.js";import{c as se,a as p,b as Oe,d as He}from"./index.esm-65d2e63a.js";import{u as Ue,a as Ve,b as We}from"./useCities-69ee90b0.js";import{b as Ie}from"./index.esm-bb4ad11f.js";import{g as Ze}from"./index-08b3b984.js";function Qe(s){return xe({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M8 4C8 5.10457 7.10457 6 6 6 4.89543 6 4 5.10457 4 4 4 2.89543 4.89543 2 6 2 7.10457 2 8 2.89543 8 4ZM5 16V22H3V10C3 8.34315 4.34315 7 6 7 6.82059 7 7.56423 7.32946 8.10585 7.86333L10.4803 10.1057 12.7931 7.79289 14.2073 9.20711 10.5201 12.8943 9 11.4587V22H7V16H5ZM10 5H19V14H10V16H14.3654L17.1889 22H19.3993L16.5758 16H20C20.5523 16 21 15.5523 21 15V4C21 3.44772 20.5523 3 20 3H10V5Z"}}]})(s)}const Ye=()=>{var P;const s=qe(n=>n),[i,d]=r.useState({}),l=M(n=>n.auth.user),f=pe(),[a,g]=r.useState(null),[N,v]=r.useState(!0),[y,_]=r.useState(null),[B,E]=r.useState([]),[b,c]=r.useState([]),[t,u]=r.useState([]),[w,o]=r.useState(!1),[L,S]=r.useState(!1),[k,j]=r.useState(!1),[A,W]=r.useState(0);r.useEffect(()=>{if(l.uid){const n=te(ce(D,"users/"+l.uid),m=>{d(m.data())});return()=>{n()}}},[l.uid]),r.useEffect(()=>{z()},[i]),r.useEffect(()=>{typeof l.max_rank=="string"?q(l.max_rank):q("none")},[l.max_rank]),r.useEffect(()=>{l.uid&&(l.uid!="7iRezG7E6vRq7OQywQN3WawSa872"&&R(F(D,"users/"+l.uid,"/left-points")).then(n=>{c(m=>[...m,...n.docs.map(C=>({side:"left",...C.data()}))])}),R(F(D,"users/"+l.uid,"/right-points")).then(n=>{c(m=>[...m,...n.docs.map(C=>({side:"right",...C.data()}))])}))},[l.uid]),r.useEffect(()=>{const n=()=>{const m=F(D,`users/${l.uid}/automatic-franchises`),C=te(m,T=>{let I=0;T.forEach(J=>{const me=Number(J.data().automatic_franchise_cap_current);I+=me}),W(I)},T=>{console.log("Error en la función getAutomaticFranchisesTotalProfits",T)});return()=>C()};l&&l.uid&&(l.has_automatic_franchises?n():W(0))},[l]),r.useEffect(()=>{l.uid&&R(H(F(D,"users/"+l.uid+"/payroll"),U("created_at","desc"),he(1))).then(n=>{n.empty||_(n.docs[0].data())})},[l.uid]),r.useEffect(()=>{const n=y?H(F(D,"users/"+l.uid+"/profits_details"),ae("created_at",">=",y.created_at),U("created_at","asc")):H(F(D,"users/"+l.uid+"/profits_details"),U("created_at","asc"));R(n).then(m=>{E(()=>m.docs.map(C=>C.data()))})},[y]);const q=async n=>{v(!0);try{const m=await fetch(`https://empowerit-api.vercel.app/ranks/getRankKey/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_user:l.uid})});if(!m.ok)throw new Error("Network response was not ok");const C=await m.json();g(C),v(!1)}catch(m){return v(!1),{status:"error",error:m}}},z=()=>{var n;if(i&&i.created_at){const m=(n=i.created_at)==null?void 0:n.toDate();j(m>=new Date("2023-12-05T00:00:00"))}},$=(...n)=>{u(B.filter(m=>n.includes(m.type))),o(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 w-full",children:[e.jsx("div",{className:"card hover:shadow-lg transition duration-150 ease-in-out hover:dark:border-gray-400 card-border cursor-pointer user-select-none",role:"presentation",onClick:()=>f("/rank"),children:e.jsxs("div",{className:"flex p-4 justify-between bg-slate-100 rounded-[10px] h-full",children:[e.jsxs("div",{className:"flex flex-col ",children:[e.jsx("p",{children:"Rango Máximo Alcanzado"}),N?e.jsx(ue,{className:"select-loading-indicatior",size:40}):e.jsx("p",{className:"text-[24px] font-bold",children:(a==null?void 0:a.display)||""})]}),e.jsx("div",{className:"flex flex-col justify-center",children:a!=null&&a.key&&(a==null?void 0:a.key)!="none"?e.jsx("img",{src:`/img/insignias/${a==null?void 0:a.key}.png`,width:40,height:40}):null})]})}),e.jsx("div",{className:"card hover:shadow-lg transition duration-150 ease-in-out hover:dark:border-gray-400 card-border cursor-pointer user-select-none",role:"presentation",children:e.jsxs("div",{className:"flex p-4 justify-between bg-slate-100 rounded-[10px] h-full",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{children:"Ganancias obtenidas"}),e.jsxs("p",{className:"text-[24px] font-bold",children:["$",((P=i==null?void 0:i.profits)==null?void 0:P.toFixed(2))||0," ",e.jsx("span",{className:"text-[20px]",children:"USD"})]})]}),e.jsx("div",{className:"flex flex-col justify-center",children:e.jsx(fe,{})})]})}),e.jsx("div",{className:"card hover:shadow-lg transition duration-150 ease-in-out hover:dark:border-gray-400 card-border cursor-pointer user-select-none",role:"presentation",children:e.jsxs("div",{className:"flex p-4 justify-between bg-slate-100 rounded-[10px] h-full",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{children:"Miembros Directos"}),e.jsx("p",{className:"text-[24px] font-bold",children:(i==null?void 0:i.count_direct_people)||0})]}),e.jsx("div",{className:"flex flex-col justify-center",children:e.jsx(le,{})})]})}),e.jsx("div",{className:"card hover:shadow-lg transition duration-150 ease-in-out hover:dark:border-gray-400 card-border cursor-pointer user-select-none",role:"presentation",children:e.jsxs("div",{className:"flex p-4 justify-between bg-slate-100 rounded-[10px] h-full",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{children:"Miembros organización"}),e.jsx("p",{className:"text-[24px] font-bold",children:(i==null?void 0:i.count_underline_people)||0})]}),e.jsx("div",{className:"flex flex-col justify-center",children:e.jsx(le,{})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-4",children:[e.jsxs(Q,{onClick:()=>$("bond_quick_start","bond_founder"),children:[e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx("div",{className:"rounded-full h-[40px] w-[40px] p-2 flex items-center justify-center bg-gray-300",children:e.jsx(Pe,{size:30,className:"text-yellow-600"})}),e.jsx("span",{className:"text-lg font-medium",children:"Bono Inicio Rápido"})]}),e.jsx("div",{className:"grid grid-cols-[max-content_1fr] gap-x-4 pl-2 text-xl",children:e.jsxs("span",{className:"font-bold text-right",children:["$"," ",e.jsx("span",{className:"text-3xl",children:((i==null?void 0:i.bond_quick_start)??0)+((i==null?void 0:i.bond_founder)??0)})," ","USD"]})})]}),e.jsxs(Q,{onClick:()=>$("bond_binary"),children:[e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx("div",{className:"rounded-full h-[40px] w-[40px] p-2 flex items-center justify-center bg-gray-300",children:e.jsx(Re,{size:30,className:"text-gray-700"})}),e.jsx("span",{className:"text-lg font-medium",children:"Bono Binario"})]}),e.jsx("div",{className:"grid grid-cols-[max-content_1fr] gap-x-4 pl-2 text-xl",children:e.jsxs("span",{className:"font-bold text-right",children:[e.jsx("span",{className:"text-3xl",children:(a==null?void 0:a.binary_percent)*100})," %"]})})]}),e.jsxs(Q,{onClick:()=>$("bond_mentor"),children:[e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx("div",{className:"rounded-full h-[40px] w-[40px] p-2 flex items-center justify-center bg-gray-300",children:e.jsx(Me,{size:30,className:"text-green-700"})}),e.jsx("span",{className:"text-lg font-medium",children:"Bono Mentor"})]}),e.jsx("div",{className:"grid grid-cols-[max-content_1fr] gap-x-4 pl-2 text-xl",children:e.jsxs("span",{className:"font-bold text-right",children:[e.jsx("span",{className:"text-3xl",children:(a==null?void 0:a.mentor_percent)*100})," %"]})})]}),e.jsxs(Q,{children:[e.jsxs("div",{className:"flex space-x-2 items-center",children:[e.jsx("div",{className:"rounded-full h-[40px] w-[40px] p-2 flex items-center justify-center bg-gray-300",children:e.jsx(Qe,{size:30,className:"text-purple-500"})}),e.jsx("span",{className:"text-lg font-medium",children:"Mis Franq. Aut."})]}),e.jsx("div",{className:"grid grid-cols-[max-content_1fr] gap-x-4 pl-2 text-xl",children:e.jsxs("span",{className:"font-bold text-right",children:["$"," ",e.jsx("span",{className:"text-3xl",children:Ae(A??0,2)})," ","USD"]})})]})]}),e.jsx(V,{isOpen:w,width:700,onClose:()=>o(!1),children:e.jsx("div",{className:"p-4",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left",children:"Concepto"}),e.jsx("th",{className:"text-left",children:"Usuario"}),e.jsx("th",{className:"text-right",children:"USD"}),e.jsx("th",{className:"text-right",children:"Fecha"})]})}),e.jsxs("tbody",{children:[t.map((n,m)=>e.jsxs("tr",{children:[e.jsx("td",{children:n.description}),e.jsx("td",{children:e.jsx("span",{className:"text-blue-500 underline hover:cursor-pointer",onClick:()=>s.openModal(n.id_user),children:n.user_name})}),e.jsx("td",{className:"text-right",children:n.amount}),e.jsx("td",{className:"text-right",children:n.created_at.seconds?de(n.created_at.seconds*1e3).format("DD/MM/YYYY HH:mm:ss"):null})]},m)),t.length==0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-left",children:"No hay datos"})})]})]})})}),e.jsx(V,{isOpen:L,width:700,onClose:()=>S(!1),children:e.jsx("div",{className:"p-4 max-h-[50vh] overflow-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left",children:"Usuario"}),e.jsx("th",{className:"text-left",children:"Lado"}),e.jsx("th",{className:"text-right",children:"Puntos"}),e.jsx("th",{className:"text-right",children:"Expiran"})]})}),e.jsxs("tbody",{children:[b.map((n,m)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"text-blue-500 underline hover:cursor-pointer",onClick:()=>{s.openModal(n.user_id),S(!1)},children:n.name})}),e.jsx("td",{children:n.side}),e.jsx("td",{className:"text-right",children:n.points})]},m)),b.length==0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-left",children:"No hay datos"})})]})]})})})]})},Q=({children:s,onClick:i})=>e.jsx("div",{className:"bg-slate-100 rounded-[10px] p-4 card-border cursor-pointer user-select-none hover:shadow-lg flex flex-col space-y-2",onClick:i,children:s}),Ge=()=>{const s=M(f=>f.auth.user),i=!!s.wallet_litecoin,d=!!s.rfc,l=!!s.bank_account;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col w-full bg-slate-100 p-4 rounded-[10px]",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h5",{children:"Resumen Usuario"})}),e.jsxs("div",{className:"flex items-center mb-2",children:[i?e.jsx(K,{className:"text-green-600"}):e.jsx(X,{className:"text-red-500"}),e.jsxs("div",{className:"flex flex-col ml-4",children:[e.jsx("span",{className:"text-[16px] font-bold",children:"Wallet Litecoin"}),i?e.jsx("p",{className:"text-green-600",children:"Capturada"}):e.jsx("a",{href:"/billing",children:e.jsx("p",{className:"text-red-500",children:"Pendiente"})})]})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[d?e.jsx(K,{className:"text-green-600"}):e.jsx(X,{className:"text-red-500"}),e.jsxs("div",{className:"flex flex-col ml-4",children:[e.jsx("span",{className:"text-[16px] font-bold",children:"RFC"}),d?e.jsx("p",{className:"text-green-600",children:"Capturada"}):e.jsx("a",{href:"/billing",children:e.jsx("p",{className:"text-red-500",children:"Pendiente"})})]})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[l?e.jsx(K,{className:"text-green-600"}):e.jsx(X,{className:"text-red-500"}),e.jsxs("div",{className:"flex flex-col ml-4",children:[e.jsx("span",{className:"text-[16px] font-bold",children:"Cuenta de Banco"}),l?e.jsx("p",{className:"text-green-600",children:"Capturada"}):e.jsx("a",{href:"/billing",children:e.jsx("p",{className:"text-red-500",children:"Pendiente"})})]})]})]})})},Je=()=>{const[s,i]=r.useState("");return r.useEffect(()=>{i(window.location.host)},[]),{copyLink:r.useCallback(async(l,f)=>{try{const a=await je(l,f);if(a){const g=f==="left"?a.left:a.right,N=`${s}/sign-up/${l}/${g}`;return await navigator.clipboard.writeText(N),g}}catch{}},[s])}},Ke=()=>{const s=M(a=>a.auth.user),[i,d]=r.useState(""),{copyLink:l}=Je();r.useEffect(()=>{d(window.location.host)},[]);const f=a=>{l(s.uid,a),Y.push(e.jsx(G,{title:"Link copiado",type:"success"}),{placement:"top-center"})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col bg-slate-100 p-4 rounded-[10px] h-fit w-full",children:[e.jsx("h5",{children:"Links de registro"}),e.jsx("p",{children:"Comparte tu link para el registro de tus referidos"}),e.jsxs("div",{className:" border border-slate-300 p-4 mt-2  rounded-[8px] space-y-2",children:[e.jsxs("span",{children:["Links autogenerados por ",e.jsx("strong",{children:"EMPOWERIT TOP"})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-4",children:[e.jsx("div",{className:" b bg-white flex-1 p-2 rounded-[8px] w-[0%] border border-slate-300",children:e.jsxs("p",{className:Z("truncate"),children:[i,"/sign-up/",s==null?void 0:s.uid,"/",s==null?void 0:s.left]})}),e.jsx("button",{className:Z("p-2 rounded-[8px] border border-slate-300","hover:border-slate-600 bg-white"),onClick:()=>f("left"),children:"Copiar link izq."})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-4",children:[e.jsx("div",{className:" b bg-white flex-1 p-2 rounded-[8px] w-[0%] border border-slate-300",children:e.jsxs("p",{className:Z("truncate"),children:[i,"/sign-up/",s==null?void 0:s.uid,"/",s==null?void 0:s.right]})}),e.jsx("button",{className:Z("p-2 rounded-[8px] border border-slate-300","hover:border-slate-600 bg-white"),onClick:()=>f("right"),children:"Copiar link der."})]})]})]})})},Xe=({data:s,setOpenWelcomeModal:i})=>{const d=be(),l={label:"",value:""},[f,a]=r.useState(null),[g,N]=r.useState(null),[v,y]=r.useState(null),_=Ue(),B=Ve(f??l);We(g??l);const E=(t,u)=>{Y.push(e.jsx(G,{title:"Perfil actualizado",type:"success"}),{placement:"top-center"}),u(!1),i(!1)},b=t=>{var u,w,o;(u=t==null?void 0:t.country)!=null&&u.value&&!f&&a(t.country),(w=t==null?void 0:t.state)!=null&&w.value&&!g&&N(t.state),(o=t==null?void 0:t.city)!=null&&o.value&&!v&&y(t.city)};r.useEffect(()=>{b(s)},[s]);const c=se().shape({name:p().required("User Name Required"),birthdate:Oe().required("Date Required"),wallet_litecoin:p().optional(),rfc:p().optional(),bank_account:p().optional(),country:se().shape({value:p().required("Country is required")}),state:se().shape({value:p().required("State is required")}),city:p().required("City is required"),whatsapp:p().required("Phone Required"),zip:p().required("Zip Required"),num_ext:p().required("Num_ext Required"),num_int:p(),reference:p(),street:p().required("Address Required"),colony:p().required("Colony Required"),title:p(),lang:p(),timeZone:p(),syncData:He(),nombreBeneficiario1:p().matches(/^[A-Za-z\s]+$/,"Este campo solo acepta letras"),telefonoBeneficiario1:p().matches(/^[0-9]+$/,"Este campo solo acepta números"),parentescoBeneficiario1:p().matches(/^[A-Za-z\s]+$/,"Este campo solo acepta letras"),nombreBeneficiario2:p().matches(/^[A-Za-z\s]+$/,"Este campo solo acepta letras"),telefonoBeneficiario2:p().matches(/^[0-9]+$/,"Este campo solo acepta números"),parentescoBeneficiario2:p().matches(/^[A-Za-z\s]+$/,"Este campo solo acepta letras")});return e.jsx($e,{initialValues:{...s},enableReinitialize:!0,validationSchema:c,onSubmit:async(t,{setSubmitting:u})=>{u(!0);try{const{name:w,birthdate:o,whatsapp:L,telegram:S,instagram:k,email:j,nombreBeneficiario1:A,telefonoBeneficiario1:W,parentescoBeneficiario1:q,nombreBeneficiario2:z,telefonoBeneficiario2:$,parentescoBeneficiario2:P}=t,n={country:f,state:g,city:{label:t.city,value:t.city},street:t.street,zip:t.zip,num_ext:t.num_ext,num_int:t.num_int||"",reference:t.reference||"",colony:t.colony},m={birthdate:o||""},C={name:w.trim()||"",whatsapp:L||"",telegram:S||"",instagram:(k==null?void 0:k.trim())||""},T={rfc:t.rfc,wallet_litecoin:t.wallet_litecoin,bank_account:t.bank_account},I={beneficiario1:{nombre:(A==null?void 0:A.trim())||"",telefono:W||"",parentesco:(q==null?void 0:q.trim())||""},beneficiario2:{nombre:(z==null?void 0:z.trim())||"",telefono:$||"",parentesco:(P==null?void 0:P.trim())||""}},J={...m,...C,...I,...n,...T,email:j==null?void 0:j.trim()};j.trim()&&(j==null?void 0:j.trim())!=s.email&&await ge(j==null?void 0:j.trim()),await Ne(t.uid,J),["alive-pack","freedom-pack","business-pack"].includes(s.membership),d(ye({...t})),setTimeout(()=>{E(t,u)},1e3)}catch(w){console.log(w),Y.push(e.jsx(G,{title:"Ha ocurrido un error",type:"danger"}),{placement:"top-center"})}},children:t=>{const{values:u,touched:w,errors:o,isSubmitting:L,setFieldValue:S}=t,k={touched:w,errors:o};return e.jsxs(Te,{children:[e.jsx(ze,{title:"¡Felicidades por formar parte de la compañía que esta revolucionando la forma de hacer negocios!",desc:"Completa los siguientes datos para poder disfrutar al máximo de Empowerit TOP"}),e.jsxs(ve,{children:[e.jsxs(O,{name:"basic",label:"Datos básicos",...k,children:[e.jsx(x,{type:"text",autoComplete:"off",name:"name",placeholder:"Nombre",component:h,prefix:e.jsx(ee,{className:"text-xl"})}),e.jsx(x,{className:"mt-2 ltr:mr-2 rtl:ml-2",type:"date",autoComplete:"off",name:"birthdate",placeholder:"Fecha de nacimiento",component:h,prefix:e.jsx(Ce,{className:"text-xl"})})]}),e.jsxs(O,{name:"payroll",label:"Métodos de pago",...k,children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold",children:"Wallet de Litecoin"})," ",e.jsx("span",{className:"text-red-500 text-xs",children:"(Obligatorio)"})]}),e.jsx(x,{type:"text",autoComplete:"off",name:"wallet_litecoin",placeholder:"Dirección",component:h,prefix:e.jsx(Ie,{className:"text-xl"})}),e.jsx("div",{className:"mt-2 ltr:mr-2 rtl:ml-2",children:e.jsx("span",{className:"font-bold",children:"RFC"})}),e.jsx(x,{type:"text",autoComplete:"off",name:"rfc",placeholder:"RFC",component:h,prefix:e.jsx(Le,{className:"text-xl"})}),e.jsx("div",{className:"mt-2 ltr:mr-2 rtl:ml-2",children:e.jsx("span",{className:"font-bold",children:"Cuenta de Banco (CLABE)"})}),e.jsx(x,{type:"text",autoComplete:"off",name:"bank_account",placeholder:"CABLE Cuenta de Banco",component:h,prefix:e.jsx(_e,{className:"text-xl"})})]}),e.jsxs(O,{name:"location",label:"Locación",...k,children:[e.jsx(x,{className:"ltr:mr-2 rtl:ml-2",name:"country",placeholder:"País",component:re,value:f,options:_[0],onChange:j=>{a(j),S("country",j),N(null),S("state",null),y(null),S("city",null)}}),(o==null?void 0:o.country)&&e.jsx("span",{className:"text-red-500",children:"País es obligatorio"}),e.jsx(x,{className:"mt-2 ltr:mr-2 rtl:ml-2",name:"state",placeholder:"Estado",options:B[0],value:g,component:re,onChange:j=>{N(j),S("state",j),y(null),S("city",null)}}),(o==null?void 0:o.state)&&e.jsx("span",{className:"text-red-500",children:"Estado es obligatorio"}),e.jsx(x,{type:"text",autoComplete:"off",name:"city",placeholder:"Ciudad",component:h}),(o==null?void 0:o.city)&&e.jsx("span",{className:"text-red-500",children:"Ciudad es obligatorio"}),e.jsx(x,{type:"text",autoComplete:"off",name:"colony",placeholder:"Colonia",component:h}),(o==null?void 0:o.colony)&&e.jsx("span",{className:"text-red-500",children:"Colonia es obligatorio"}),e.jsxs("div",{className:"mt-2 ltr:mr-2 rtl:ml-2",children:[e.jsx("label",{children:"Calle"}),e.jsx(x,{type:"text",autoComplete:"off",name:"street",placeholder:"Dirección",component:h}),(o==null?void 0:o.street)&&e.jsx("span",{className:"text-red-500",children:"Dirección es obligatorio"})]}),e.jsxs("div",{className:"mt-2 ltr:mr-2 rtl:ml-2",children:[e.jsx("label",{children:"Código postal"}),e.jsx(x,{type:"number",autoComplete:"off",name:"zip",placeholder:"Código Postal",component:h}),(o==null?void 0:o.zip)&&e.jsx("span",{className:"text-red-500",children:"Código postal es obligatorio"})]}),e.jsxs("div",{className:"mt-2 ltr:mr-2 rtl:ml-2",children:[e.jsx("label",{children:"Número exterior"}),e.jsx(x,{type:"number",autoComplete:"off",name:"num_ext",component:h}),(o==null?void 0:o.num_ext)&&e.jsx("span",{className:"text-red-500",children:"Número exterior es obligatorio"})]}),e.jsxs("div",{className:"mt-2 ltr:mr-2 rtl:ml-2",children:[e.jsx("label",{children:"Número interior"}),e.jsx(x,{type:"number",autoComplete:"off",name:"num_int",component:h})]}),e.jsxs("div",{className:"mt-2 ltr:mr-2 rtl:ml-2",children:[e.jsx("label",{children:"Referencia"}),e.jsx(x,{type:"text",autoComplete:"off",name:"reference",placeholder:"Entre calles",component:h})]})]}),e.jsxs(O,{name:"contact",label:"Contacto",...k,children:[e.jsx(x,{type:"number",autoComplete:"off",name:"whatsapp",placeholder:"WhatsApp",component:h,prefix:e.jsx(we,{className:"text-xl"})}),(o==null?void 0:o.whatsapp)&&e.jsx("span",{className:"text-red-500",children:"Whatsapp es obligatorio"}),e.jsx(x,{className:"mt-2 ltr:mr-2 rtl:ml-2",type:"text",autoComplete:"off",name:"instagram",placeholder:"Instagram",component:h,prefix:e.jsx(Se,{className:"text-xl"})}),e.jsx(x,{className:"mt-2 ltr:mr-2 rtl:ml-2",type:"text",autoComplete:"off",name:"telegram",placeholder:"Telegram",component:h,prefix:e.jsx(ke,{className:"text-xl"})})]}),e.jsxs(O,{name:"beneficiarios",label:"Negocio Heredable",...k,children:[e.jsx(x,{className:"mt-2 ltr:mr-2 rtl:ml-2",type:"text",autoComplete:"off",name:"nombreBeneficiario1",placeholder:"Nombre del beneficiario #1",component:h,prefix:e.jsx(ee,{className:"text-xl"})}),e.jsx(x,{className:"mt-2 ltr:mr-2 rtl:ml-2",type:"text",autoComplete:"off",name:"telefonoBeneficiario1",placeholder:"Teléfono del beneficiario #1",component:h,prefix:e.jsx(ie,{className:"text-xl"})}),e.jsx(x,{className:"mt-2 ltr:mr-2 rtl:ml-2",type:"text",autoComplete:"off",name:"parentescoBeneficiario1",placeholder:"Parentesco",component:h,prefix:e.jsx(ne,{className:"text-xl"})}),e.jsx(x,{className:"mt-2 ltr:mr-2 rtl:ml-2",type:"text",autoComplete:"off",name:"nombreBeneficiario2",placeholder:"Nombre del beneficiario #2",component:h,prefix:e.jsx(ee,{className:"text-xl"})}),e.jsx(x,{className:"mt-2 ltr:mr-2 rtl:ml-2",type:"text",autoComplete:"off",name:"telefonoBeneficiario2",placeholder:"Teléfono del beneficiario #2",component:h,prefix:e.jsx(ie,{className:"text-xl"})}),e.jsx(x,{className:"mt-2 ltr:mr-2 rtl:ml-2",type:"text",autoComplete:"off",name:"parentescoBeneficiario2",placeholder:"Parentesco",component:h,prefix:e.jsx(ne,{className:"text-xl"})})]}),e.jsx("div",{className:"mt-4 ltr:text-right",children:e.jsx(De,{variant:"solid",loading:L,type:"submit",children:"Actualizar"})})]})]})}})},es={"100-pack":"F100","300-pack":"F300","500-pack":"F500","1000-pack":"F1000","2000-pack":"F2000"};function ss(){const s=M(b=>b.auth.user),[i,d]=r.useState(!1),[l,f]=r.useState(null),[a,g]=r.useState([]);if(r.useEffect(()=>{s&&s.membership&&B()},[]),r.useEffect(()=>{s&&l&&E()},[l]),!s||s.membership_cap_current===void 0||s.membership_cap_limit===void 0)return null;const N=s.membership_cap_current,v=s.membership_cap_limit,y=N/v*100,_=y>=80?"bg-red-500":"bg-indigo-400",B=async()=>{let b=null;if(s.uid&&s.membership){const c=H(F(D,"users",s.uid,"cycles"),ae("type","==",s.membership),U("created_at","desc")),t=await R(c);t.empty||(b=t.docs[0].data().created_at.toDate())}f(b)},E=async()=>{const b=[];if(s.uid&&l){const c=H(F(D,"users",s.uid,"payroll"),ae("created_at",">=",l),U("created_at","desc")),t=await R(c);for(const u of t.docs)b.push({created_at:u.data().created_at.toDate(),total:u.data().total})}g(b)};return e.jsxs("div",{children:[e.jsxs("div",{className:"card p-4  card-border bg-slate-100 rounded-[10px] flex flex-col hover:cursor-pointer hover:shadow-lg",onClick:()=>d(!0),children:[s.membership&&typeof s.membership=="string"&&e.jsx("span",{className:"mx-auto font-bold text-xl uppercase",children:es[s.membership]}),e.jsxs("div",{className:"w-full bg-white h-[30px] rounded-full my-4 mx-auto",children:[e.jsx("div",{style:{minWidth:"80px",width:`${y}%`},className:`rounded-full h-[30px] flex text-center justify-center text-white ${_}`,children:e.jsx("span",{className:"font-bold pt-1",children:s.membership_cap_current.toFixed(2)})}),e.jsxs("div",{className:"justify-between flex font-bold mt-1",children:[e.jsx("span",{className:"text-left",children:"0"}),e.jsxs("span",{className:"text-right",children:["CAP ",s.membership_cap_limit]})]})]})]}),e.jsxs(V,{isOpen:i,onClose:()=>d(!1),children:[e.jsx("p",{className:"text-2xl font-semibold text-center",children:"Historial"}),e.jsxs("p",{className:"font-semibold",children:["Fecha de adquisición de la franquicia:"," ",e.jsx("span",{className:"font-normal",children:l?l.toLocaleDateString():"No hay registro"})]}),l&&(a&&a.length>0?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-semibold",children:"Pagos registrados:"}),a.map((b,c)=>e.jsx("div",{children:e.jsxs("p",{className:"font-semibold",children:[b.created_at.toLocaleDateString()," ","=>"," ",e.jsxs("span",{className:"font-normal",children:["$",b.total.toFixed(2)]})]})},c))]}):"Aún no hay registros de pago")]})]})}const oe="modal-2",ts=()=>{const[s,i]=r.useState(!1),d=M(c=>c.auth.user),[l,f]=r.useState({}),a=M(c=>c.auth.user),g=c=>["name","email","country","state","city","num_ext","birthdate","whatsapp","street","zip"].every(u=>!!c[u]),[N,v]=r.useState(!g(a)||!1);r.useEffect(()=>{const c=window.localStorage.getItem(oe);a&&a.uid&&(v(!g(a)),a.is_admin||!c&&!N&&i(!0))},[a.uid]),r.useEffect(()=>{if(d.uid){const c=te(ce(D,"users/"+d.uid),t=>{f(t.data()),b()});return()=>{c()}}},[d.uid]),r.useEffect(()=>{a&&a.uid&&(v(!g(a)),["JpdntP2OQzNSBi3IylyMfSEqqSD2","7iRezG7E6vRq7OQywQN3WawSa872"].includes(a.uid)||N||i(!0))},[a.uid]);const y=()=>{window.localStorage.setItem(oe,"1"),i(!1),v(!1)},_=c=>{const t=(c==null?void 0:c.membership_status)==="paid",u=Ze(de(c==null?void 0:c.membership_expires_at));return{isActive:t,restDays:u}},B=(c,t,u)=>{Y.push(e.jsx(G,{closable:!0,title:c,type:t,duration:u}))},E=()=>{if(_(d).isActive&&_(d).restDays<=5){const c=`Su membresía de tipo Pro está por vencer. ${_(d).restDays} días restantes`,t=_(d).restDays>3?"warning":"danger";B(c,t,6e5)}},b=()=>{E()};return e.jsxs(Fe,{children:[e.jsx(V,{isOpen:s,onClose:y,children:e.jsx("div",{className:"py-5",children:e.jsx("img",{src:"/img/retiro-de-liderazgo-mexico-colombia.jpg"})})}),e.jsx("div",{className:"card hover:shadow-lg transition duration-150 ease-in-out hover:dark:border-gray-400  p-4  card-border bg-slate-100 rounded-[10px]",role:"presentation",children:e.jsx("img",{src:"/img/dashboard/banner-1-empowerit-top.jpg",className:"w-full"})}),e.jsx(Ye,{}),d&&d.membership_cap_limit&&typeof d.membership_cap_current=="number"&&typeof d.membership_cap_limit=="number"?e.jsx(ss,{}):null,e.jsx("div",{className:"card hover:shadow-lg transition duration-150 ease-in-out hover:dark:border-gray-400  p-4  card-border bg-slate-100 rounded-[10px]",role:"presentation",children:e.jsx("img",{src:"/img/dashboard/banner-horizontal-emp-top-2.jpg",className:"w-full"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[30%_70%] gap-x-4 gap-y-4",children:[e.jsx(Ge,{}),d&&d.membership!="49-pack"&&e.jsx(Ke,{})]}),e.jsx(V,{isOpen:N,width:1e3,closable:!0,onClose:y,children:e.jsx(Xe,{data:a,setOpenWelcomeModal:v})})]})};Be("salesDashboard",Ee);const as=()=>e.jsx("div",{className:"flex flex-col gap-4 h-full",children:e.jsx(ts,{})}),us=as;export{us as default};
